import{d as Y,s as f,r as Z,o as $,a as tt,w as et,b as I,c as _,e as S,f as d,g as h,h as e,i as r,t as o,p as ot,j as N,l as E,F as V,m as P,k as c,n as v,v as at,_ as m}from"./index-C8i1NBWL.js";import{u as st,s as nt,b as lt,c as it,r as C,f as rt,g as ct,h as dt,n as w,i as ut,j as M,C as T,v as _t,k as vt,l as mt,p as ht}from"./userStore-u9qmRA6a.js";import{G as gt}from"./getListAPI-o9mlSGCe.js";const pt={class:"content"},ft={class:"sign-form noPrint"},St=e("p",{class:"title"},"軟體申請單",-1),Ct={class:"area"},bt={class:"area-row"},Dt={class:"area-title-50"},It={class:"area-title-50"},Nt={class:"area-row"},Et={class:"area-title-50"},wt={class:"area-title-50"},Rt={class:"area-row"},At={class:"area-title"},yt={class:"area-row"},Bt={class:"area-title"},Ot={class:"area-row"},xt={class:"area-title"},Vt=e("hr",{style:{border:"1px dashed var(--gray-border)"}},null,-1),Pt={class:"area-row"},Mt={class:"area-title-50"},Tt={class:"area-title-50"},Gt={class:"area-row"},Lt={class:"area-title"},Ft={class:"area-row"},kt={class:"area-title"},Ut={class:"area-row"},Ht={class:"area-title"},zt={class:"area-row"},Wt={class:"area-title"},jt={class:"area-row"},Qt=e("div",{class:"area-title"},"修改前內容：",-1),qt={class:"area-row"},Jt=e("div",{class:"area-title"},"修改後內容：",-1),Kt={class:"area-row"},Xt={class:"area-title"},Yt={class:"area-row"},Zt={class:"area-title"},$t=e("p",{class:"version"},"QP-038-07-H",-1),te={class:"print-area"},ee=e("div",{class:"print-block"},[e("p",{class:"print-title"},"橙的電子股份有限公司"),e("p",{class:"print-subtitle"},"軟體申請單")],-1),oe={class:"print-form"},ae={class:"print-table"},se=e("th",{class:"table-5"},null,-1),ne=e("th",{class:"table-15"},null,-1),le=e("th",{class:"table-15"},null,-1),ie=e("th",{class:"table-15"},null,-1),re=e("th",{class:"table-20"},null,-1),ce=e("th",{class:"table-15"},null,-1),de=e("th",{class:"table-15"},null,-1),ue=[se,ne,le,ie,re,ce,de],_e=e("td",{class:"table-5",colspan:"2"},"申請原因",-1),ve={class:"table-15",colspan:"3"},me=e("td",{class:"table-15"},"日期",-1),he={class:"table-15"},ge=e("td",{class:"table-5",colspan:"2"},"申請單位",-1),pe={class:"table-15"},fe=e("td",{class:"table-15"},"申請人",-1),Se={class:"table-20"},Ce=e("td",{class:"table-15"},"主管",-1),be={class:"table-15"},De=e("td",{class:"table-5",colspan:"2"},"程式版號",-1),Ie={class:"table-15"},Ne=e("td",{class:"table-15"},"程式名稱",-1),Ee={class:"table-20",colspan:"3"},we=e("td",{class:"table-5",colspan:"2"},"SVN版號",-1),Re={class:"table-15"},Ae=e("td",{class:"table-15"},"適用機種",-1),ye={class:"table-20",colspan:"3"},Be=e("td",{class:"table-5",colspan:"2"},"台灣四階料號",-1),Oe={class:"table-15"},xe=e("td",{class:"table-15"},"Model NO",-1),Ve={class:"table-20"},Pe={class:"table-15",rowspan:"2"},Me={class:"table-15",rowspan:"2"},Te=e("td",{class:"table-5",colspan:"2"},"蘇州四階料號",-1),Ge={class:"table-15"},Le=e("td",{class:"table-15"},"Model NO",-1),Fe={class:"table-20"},ke=e("td",{class:"table-5",rowspan:"2"},"內容簡述",-1),Ue=e("td",{class:"table-15"},"修改前內容",-1),He={class:"table-15",colspan:"5"},ze=e("td",{class:"table-15"},"修改後內容",-1),We={class:"table-15",colspan:"5"},je=e("td",{class:"table-5",colspan:"2"},"相關文件",-1),Qe={class:"table-15",colspan:"5"},qe={class:"print-form"},Je={class:"print-table"},Ke=e("tr",null,[e("th",{colspan:"3"},"簽核人員")],-1),Xe={class:"table-25"},Ye={class:"table-25"},Ze=["src"],$e={class:"table-50"},to={class:"print-table"},eo=e("tr",null,[e("th",{colspan:"3"},"會辦人員")],-1),oo={class:"table-25"},ao={class:"table-25"},so=["src"],no={class:"table-50",colspan:"5"},lo=e("p",{class:"version"},"QP-038-07-H",-1),_o=Y({__name:"softSign",setup(io){const G=v(()=>m(()=>import("./LoadingGIF-EHAp8heU.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)),L=v(()=>m(()=>import("./SignBox-4LjAmvCf.js"),__vite__mapDeps([4,2,3,5,1,6]),import.meta.url)),F=v(()=>m(()=>import("./CountersignBox-KLEM5jNj.js"),__vite__mapDeps([7,2,3,5,1,8]),import.meta.url)),k=v(()=>m(()=>import("./VoidBox-tHb8pDs4.js"),__vite__mapDeps([9,2,3,5,1,10]),import.meta.url)),U=v(()=>m(()=>import("./SignTopBtn-njaXMl2d.js"),__vite__mapDeps([11,2,3,12,5,1]),import.meta.url)),H=v(()=>m(()=>import("./SignForm-cH-YHgK9.js"),__vite__mapDeps([13,2,3,5,1,14]),import.meta.url)),z=v(()=>m(()=>import("./FileCom-k_RcCnuG.js"),__vite__mapDeps([15,2,3,5]),import.meta.url)),W=st(),p=nt(),b=lt(),g=it(),{userStoreData:R}=f(W),{signStoreData:i}=f(p),{baseStoreData:j}=f(b),{createStoreData:A}=f(g),t=Z({formId:"",isLoading:!1,runningCount:0,signPicture:"https://esys.orange-electronic.com/Image/SignerPicture/",showSignBox:0,showCountersignBox:0,showVoidBox:0,disabledBtn:!1,signModalData:{radio:1,password:"",opinion:""},countersign:[],model:"sign",toFileCom:"RDDForm",formAllData:{formCodeName:"RDD",formCodeName2:"soft",routeList:"/soft",updateFormsAPI:"RDDAdd",formName:"軟體申請單",webNameForm:"RDDForm",webNameSign:"RDDSign",finishSign:{RDDId:"",Status:"2",Type:"1"},returnSign:{RDDId:"",Status:"3",Type:"1"},voidSign:{RDDId:"",Status:"4",Type:"1"},clearId:{RDDId:"",Type:2}},formContent:{}});$(()=>{const s=tt();console.log("route",s.params),t.value.formId=s.params.formId,t.value.formAllData.returnSign.RDDId=s.params.formId,t.value.formAllData.finishSign.RDDId=s.params.formId,t.value.formAllData.voidSign.RDDId=s.params.formId,b.getBranchData({DeptId:"",DeptName:""}),b.getPersonData({DeptId:"",EmpId:"",Company:""}),q(t.value.formId)}),et(()=>t.value.runningCount,s=>{console.log("watch",s),t.value.isLoading=!0,t.value.runningCount===0&&(t.value.isLoading=!1)});function y(s){t.value.showSignBox=s}function B(s){t.value.showCountersignBox=s}function O(s){t.value.showVoidBox=s}function Q(s){t.value.disabledBtn=s}async function q(s){const a={formId:s,webNameSign:"RDDSign"};t.value.runningCount++,await gt({Formno:s,status:"",Coid:"",DeptId:"",Startdt:"",Enddt:"",type:"1",Createid:""}).then(async n=>{var u;console.log("表單內容",n.data[0]),n.data[0].choiceDocArr=(u=n.data[0].choiceDoc)==null?void 0:u.split(","),await p.fetchSigner(a),await p.fetchSignStep(a),n.data[0].director=i.value.signStep.find(D=>D.STEPNAME==="一階主管"),t.value.formContent=n.data[0],t.value.runningCount--}).catch(n=>{t.value.runningCount--,console.log(n),C("API取得表單內容發生錯誤")})}async function J(s){t.value.signModalData=s,t.value.runningCount++,await rt({FORMNO:t.value.formId,SIGNORDER:i.value.signer.SIGNORDER,STEPNAME:i.value.signer.STEPNAME,SIGNER:i.value.signer.SIGNER,SIGNERNAME:i.value.signer.SIGNERNAME,ACTUALNAME:i.value.signer.ACTUALNAME,ACTUALSIGNER:i.value.signer.ACTUALSIGNER,SIGNRESULT:t.value.signModalData.radio,OPINION:t.value.signModalData.opinion,SIGNTIME:"",ALLOWCUSTOM:i.value.signer.ALLOWCUSTOM,SignGroup:i.value.signer.SignGroup,ISEnable:i.value.signer.ISEnable,types:1,ExceId:t.value.formContent.CreateId?t.value.formContent.CreateId:t.value.formContent.Empid,Status:""}).then(async a=>{if(console.log("簽核成功",a),a.data==="更新完成"&&(t.value.disabledBtn=!0),j.value.file.length>0&&await ct(t.value)===!1)throw"檔案上傳錯誤"}).then(async()=>{const a={formId:t.value.formId,formName:"軟體申請單"};t.value.signModalData.radio===1?(await g.fetchNextSigner(a),A.value.nextSigner?await g.sendMail(a):(A.value.nextSigner={},await dt(t.value),await w(t.value,"完簽"))):(await ut(t.value),await w(t.value,"退簽"))}).then(()=>{t.value.runningCount--,M()}).catch(a=>{t.value.runningCount--,console.log(a),C("API送簽發生錯誤")})}async function K(s){t.value.countersign=s,t.value.countersign.sort(function(a,n){return a.order-n.order}),console.log("排序後",t.value.countersign),t.value.countersign.length>0&&(t.value.runningCount++,t.value.countersign.forEach(a=>{a.FORMNO=t.value.formId.toString(),a.SIGNORDER=i.value.signer.SIGNORDER,a.STEPNAME="會簽",a.SignGroup="簽核"}),T(t.value.countersign).then(async a=>{console.log("新增會簽人員",a),a.data==="更新完成"&&(t.value.disabledBtn=!0);const n={formId:t.value.formId,formName:"軟體申請單"};t.value.countersign.length>0&&(await g.fetchNextSigner(n),await g.sendMail(n))}).then(()=>{t.value.runningCount--,M()}).catch(a=>{t.value.runningCount--,console.log(a),C("API增加會簽人員發生錯誤")}))}async function X(s){t.value.signModalData=s,t.value.runningCount++;const a=[];a.push({FORMNO:t.value.formId,SIGNER:R.value.EmpId,SIGNERNAME:R.value.EmpName,SIGNORDER:i.value.signer.SIGNORDER,STEPNAME:"作廢人員",SignGroup:"作廢"}),await T(a).then(n=>{console.log("作廢人員上傳後端",n),n.data==="更新完成"&&(t.value.disabledBtn=!0)}).then(async()=>{const n={formId:t.value.formId,formName:"軟體申請單"};await p.fetchSignStep(n),await _t(t.value),await vt(t.value),await mt(t.value),await w(t.value,"作廢")}).then(()=>{t.value.runningCount--,ht("RDD")}).catch(n=>{t.value.runningCount--,console.log(n),C("API新增作廢人員發生錯誤")})}return(s,a)=>{var x;const n=I("el-radio"),u=I("el-checkbox"),D=I("el-checkbox-group");return c(),_("div",pt,[t.value.isLoading===!0?(c(),S(d(G),{key:0})):h("",!0),t.value.showSignBox===1?(c(),S(d(L),{key:1,onHandleShowSignBox:y,onSubmitSign:J})):h("",!0),t.value.showCountersignBox===1?(c(),S(d(F),{key:2,onHandleShowCountersignBox:B,onSubmitCountersign:K})):h("",!0),t.value.showVoidBox===1?(c(),S(d(k),{key:3,onHandleShowVoidBox:O,onDeliverDisabledBtn:Q,onSubmitVoid:X})):h("",!0),e("div",ft,[St,r(d(U),{onHandleShowSignBox:y,onHandleShowCountersignBox:B,onHandleShowVoidBox:O,formContent:t.value.formContent,formAllData:t.value.formAllData,disabledBtn:t.value.disabledBtn},null,8,["formContent","formAllData","disabledBtn"]),e("div",Ct,[e("div",bt,[e("div",Dt,"申請單位："+o(t.value.formContent.applyDept),1),e("div",It,"申請原因："+o(t.value.formContent.applyReason),1)]),e("div",Nt,[e("div",Et,"程式版號："+o(t.value.formContent.programV),1),e("div",wt,"SVN版號："+o(t.value.formContent.SVNV),1)]),e("div",Rt,[e("div",At,"程式名稱："+o(t.value.formContent.programName),1)]),e("div",yt,[e("div",Bt,"適用機種："+o(t.value.formContent.Model),1)]),e("div",Ot,[e("div",xt,"IC："+o(t.value.formContent.IC),1)]),Vt,e("div",Pt,[e("div",Mt,"申請地區："+o(t.value.formContent.applyArea),1),e("div",Tt,"申請類別："+o(t.value.formContent.applyType),1)]),e("div",Gt,[e("div",Lt,"台灣四階料號："+o(t.value.formContent.bomElno),1)]),e("div",Ft,[e("div",kt,"台灣Model NO："+o(t.value.formContent.modelNO),1)]),e("div",Ut,[e("div",Ht,"蘇州四階料號："+o(t.value.formContent.suzobomElno),1)]),e("div",zt,[e("div",Wt,"蘇州Model NO："+o(t.value.formContent.suzomodelNO),1)]),e("div",jt,[Qt,e("p",null,o(t.value.formContent.reviseB),1)]),e("div",qt,[Jt,e("p",null,o(t.value.formContent.reviseA),1)]),e("div",Kt,[e("div",Xt,"相關文件是否修改："+o(t.value.formContent.reviseDoc),1)]),e("div",Yt,[e("div",Zt,"選擇修改文件："+o(t.value.formContent.choiceDoc),1)])]),r(d(z),{model:t.value.model,toFileCom:t.value.toFileCom},null,8,["model","toFileCom"]),$t,r(d(H),{class:"mt-1"})]),e("div",te,[ee,e("div",oe,[e("table",ae,[ot(e("tr",null,ue,512),[[at,!1]]),e("tr",null,[_e,e("td",ve,o(t.value.formContent.applyReason),1),me,e("td",he,o(t.value.formContent.CreateDate),1)]),e("tr",null,[ge,e("td",pe,o(t.value.formContent.applyDept),1),fe,e("td",Se,o(t.value.formContent.EmpName),1),Ce,e("td",be,o((x=t.value.formContent.director)==null?void 0:x.SIGNERNAME),1)]),e("tr",null,[De,e("td",Ie,o(t.value.formContent.programV),1),Ne,e("td",Ee,o(t.value.formContent.programName),1)]),e("tr",null,[we,e("td",Re,o(t.value.formContent.SVNV),1),Ae,e("td",ye,o(t.value.formContent.Model),1)]),e("tr",null,[Be,e("td",Oe,o(t.value.formContent.bomElno),1),xe,e("td",Ve,o(t.value.formContent.modelNO),1),e("td",Pe,"IC："+o(t.value.formContent.IC),1),e("td",Me,o(t.value.formContent.applyType),1)]),e("tr",null,[Te,e("td",Ge,o(t.value.formContent.suzobomElno),1),Le,e("td",Fe,o(t.value.formContent.suzomodelNO),1)]),e("tr",null,[ke,Ue,e("td",He,o(t.value.formContent.reviseB),1)]),e("tr",null,[ze,e("td",We,o(t.value.formContent.reviseA),1)]),e("tr",null,[je,e("td",Qe,[r(n,{modelValue:t.value.formContent.reviseDoc,"onUpdate:modelValue":a[0]||(a[0]=l=>t.value.formContent.reviseDoc=l),label:"是"},{default:N(()=>[E("是")]),_:1},8,["modelValue"]),r(n,{modelValue:t.value.formContent.reviseDoc,"onUpdate:modelValue":a[1]||(a[1]=l=>t.value.formContent.reviseDoc=l),label:"否"},{default:N(()=>[E("否")]),_:1},8,["modelValue"]),E(" 需修改 "),r(D,{modelValue:t.value.formContent.choiceDocArr,"onUpdate:modelValue":a[2]||(a[2]=l=>t.value.formContent.choiceDocArr=l)},{default:N(()=>[r(u,{label:"品質手冊"}),r(u,{label:"程序"}),r(u,{label:"作業標準書"}),r(u,{label:"表格"}),r(u,{label:"其他"})]),_:1},8,["modelValue"])])])])]),e("div",qe,[e("table",Je,[Ke,(c(!0),_(V,null,P(d(i).signStep,l=>(c(),_("tr",{key:l.SIGNORDER},[e("td",Xe,o(l.STEPNAME),1),e("td",Ye,[l.SIGNRESULT===5||l.SIGNRESULT===0?h("",!0):(c(),_("img",{key:0,class:"signPicture",src:t.value.signPicture+l.SIGNER+".png",alt:"",style:{height:"30px"}},null,8,Ze))]),e("td",$e,o(l.OPINION),1)]))),128))]),e("table",to,[eo,(c(!0),_(V,null,P(d(i).executorStep,l=>(c(),_("tr",{key:l.SIGNORDER},[e("td",oo,o(l.STEPNAME),1),e("td",ao,[l.SIGNRESULT===5||l.SIGNRESULT===0?h("",!0):(c(),_("img",{key:0,class:"signPicture",src:t.value.signPicture+l.SIGNER+".png",alt:"",style:{height:"30px"}},null,8,so))]),e("td",no,o(l.OPINION),1)]))),128))]),lo])])])}}});export{_o as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./LoadingGIF-EHAp8heU.js","./_plugin-vue_export-helper-x3n3nnut.js","./index-C8i1NBWL.js","./index-BaElX5cx.css","./SignBox-4LjAmvCf.js","./userStore-u9qmRA6a.js","./SignBox-c0FAnwi4.css","./CountersignBox-KLEM5jNj.js","./CountersignBox-aM5nM2vN.css","./VoidBox-tHb8pDs4.js","./VoidBox-7nmSBom_.css","./SignTopBtn-njaXMl2d.js","./電子表單icon_返回-ws5LyveC.js","./SignForm-cH-YHgK9.js","./SignForm-fI6EaopT.css","./FileCom-k_RcCnuG.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}