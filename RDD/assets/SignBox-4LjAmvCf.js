import{d as D,s as M,r as V,w as v,b as d,k as p,c as k,e as y,f as I,g as L,h as e,i,j as c,l as b,n as E,_ as N,z as T,A as P}from"./index-C8i1NBWL.js";import{s as R,T as m,L as A,r as U}from"./userStore-u9qmRA6a.js";import{_ as q}from"./_plugin-vue_export-helper-x3n3nnut.js";const n=l=>(T("data-v-f3d5b52b"),l=l(),P(),l),z={class:"sign-box"},G={class:"box"},j=n(()=>e("div",{class:"box-title"},"表單簽核",-1)),F=n(()=>e("div",{class:"box-info"},[e("p",{class:"box-info-text"},"● 簽核選擇不同意，請填寫簽核意見！"),e("p",{class:"box-info-text"}," ● If you do not agree,please fill in the opintion! ")],-1)),O={class:"box-content"},$={class:"box-row"},H=n(()=>e("div",{class:"box-content-text"},"簽核決定",-1)),J={class:"box-content-item"},K=n(()=>e("br",null,null,-1)),Q={class:"box-row"},W=n(()=>e("div",{class:"box-content-text"},"簽核密碼",-1)),X={class:"box-content-item"},Y={class:"box-row"},Z=n(()=>e("div",{class:"box-content-text opinion"},"簽核意見",-1)),oo={class:"box-content-item"},eo=["disabled"],ao=D({__name:"SignBox",emits:["handle-show-sign-box","submit-sign"],setup(l,{emit:f}){const x=E(()=>N(()=>import("./LoadingGIF-EHAp8heU.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)),h=R(),{signStoreData:w}=M(h),u=f,o=V({isLoading:!1,runningCount:0,showSignBox:1,disabledBtn:!1,signModalData:{radio:1,password:"",opinion:""}});v(()=>o.value.runningCount,a=>{console.log("watch",a),o.value.isLoading=!0,o.value.runningCount===0&&(o.value.isLoading=!1)}),v(()=>o.value.showSignBox,a=>{console.log("watch",a),u("handle-show-sign-box",o.value.showSignBox)});function B(){o.value.disabledBtn=!0,o.value.signModalData.password?o.value.signModalData.radio===1||o.value.signModalData.radio===2&&o.value.signModalData.opinion!==""?r():(o.value.disabledBtn=!1,m.fire({icon:"warning",title:"若不同意請填寫意見"})):(o.value.disabledBtn=!1,m.fire({icon:"warning",title:"請填寫密碼！"}))}async function r(){o.value.runningCount++,await A({acc:w.value.signer.SIGNER,Pwd:o.value.signModalData.password}).then(a=>{a.data==="密碼通過"&&(u("submit-sign",o.value.signModalData),o.value.runningCount--)}).catch(a=>{o.value.disabledBtn=!1,o.value.runningCount--,console.log(a),U("密碼錯誤")})}function C(a){const t=document.querySelector(".sign-modal");a.target===t&&(o.value.showSignBox=0)}return(a,t)=>{const _=d("el-radio"),S=d("el-radio-group"),g=d("el-input");return p(),k("div",z,[o.value.isLoading===!0?(p(),y(I(x),{key:0})):L("",!0),e("div",{class:"sign-modal",onClick:C},[e("div",G,[j,F,e("div",O,[e("div",$,[H,e("div",J,[i(S,{modelValue:o.value.signModalData.radio,"onUpdate:modelValue":t[0]||(t[0]=s=>o.value.signModalData.radio=s)},{default:c(()=>[i(_,{label:1},{default:c(()=>[b("同意")]),_:1}),K,i(_,{label:2},{default:c(()=>[b("不同意，請填寫意見")]),_:1})]),_:1},8,["modelValue"])])]),e("div",Q,[W,e("div",X,[i(g,{type:"password",modelValue:o.value.signModalData.password,"onUpdate:modelValue":t[1]||(t[1]=s=>o.value.signModalData.password=s),required:""},null,8,["modelValue"])])]),e("div",Y,[Z,e("div",oo,[i(g,{type:"textarea",autosize:{minRows:5},modelValue:o.value.signModalData.opinion,"onUpdate:modelValue":t[2]||(t[2]=s=>o.value.signModalData.opinion=s)},null,8,["modelValue"])])])]),e("button",{type:"button",class:"btn btn-black",onClick:B,disabled:o.value.disabledBtn}," 確認 ",8,eo),e("button",{type:"button",class:"btn btn-red",onClick:t[3]||(t[3]=s=>o.value.showSignBox=0)}," 取消 ")])])])}}}),io=q(ao,[["__scopeId","data-v-f3d5b52b"]]);export{io as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./LoadingGIF-EHAp8heU.js","./_plugin-vue_export-helper-x3n3nnut.js","./index-C8i1NBWL.js","./index-BaElX5cx.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}